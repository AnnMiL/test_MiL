function [TM] = intel4790fftThermalModel()
% TM: the thermal model, members are:
% lc_a/lc_i:    linear coefficient of DE in active/idel mode
% ua/ui:        the vector of the constant of DE in active/idle mode
% initT:        the initial temperature
% fftH:         the fourier transform of impulse response of the thermal LTI system.
%               should be a N times N matrix
% T_inf_a:      the state steady temperature in active mode
% coreIdx:      indicates which nodes are cores.
% p:            resolution of time vector
% tend:         tend(i,j) indicates where H(:,i,j) become 0
% isCore:       if node(i) is a core, 1 is / 0 not
% Tconstmax:    the constant impulse from non-core nodes
% n:            number of processing components
% N:            number of nodes
% sizet1.96189	0.00000	-1.26667	-0.63333	-0.06189	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
% recommend: t = 0:0.0004:35;
t = 0:0.001:50;
p = 0.00001;
name = 'intel4790cores';
INVC = diag([33.43195	33.43195	33.43195	33.43195	804.45625	804.45625	804.45625	804.45625	18.12859	18.12859	18.12859	18.12859	1.07782	1.07782	1.07782	1.07782	11.32600	11.32600	2.99983	2.99983	0.67338	0.67338	0.17835	0.17835	0.12573	0.12573	0.12573	0.12573]);
    
SplusG = [6.86184	-0.43646	-0.06238	0.00000	-6.36300	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
-0.43646	6.86184	0.00000	-0.06238	0.00000	-6.36300	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
-0.06238	0.00000	6.86184	-0.43646	0.00000	0.00000	-6.36300	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	-0.06238	-0.43646	6.86184	0.00000	0.00000	0.00000	-6.36300	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
-6.36300	0.00000	0.00000	0.00000	15.69564	-0.00021	-0.00003	0.00000	-9.33240	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	-6.36300	0.00000	0.00000	-0.00021	15.69564	0.00000	-0.00003	0.00000	-9.33240	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	-6.36300	0.00000	-0.00003	0.00000	15.69564	-0.00021	0.00000	0.00000	-9.33240	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	-6.36300	0.00000	-0.00003	-0.00021	15.69564	0.00000	0.00000	0.00000	-9.33240	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	-9.33240	0.00000	0.00000	0.00000	30.08479	-1.05810	-0.15122	0.00000	-18.66480	0.00000	0.00000	0.00000	-0.24930	0.00000	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	-9.33240	0.00000	0.00000	-1.05810	30.08479	0.00000	-0.15122	0.00000	-18.66480	0.00000	0.00000	-0.24930	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-9.33240	0.00000	-0.15122	0.00000	30.08479	-1.05810	0.00000	0.00000	-18.66480	0.00000	0.00000	-0.24930	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-9.33240	0.00000	-0.15122	-1.05810	30.08479	0.00000	0.00000	0.00000	-18.66480	0.00000	-0.24930	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-18.66480	0.00000	0.00000	0.00000	20.84525	-1.05810	-0.15122	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	0.00000	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-18.66480	0.00000	0.00000	-1.05810	20.84525	0.00000	-0.15122	0.00000	0.00000	0.00000	0.00000	-0.24930	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-18.66480	0.00000	-0.15122	0.00000	20.84525	-1.05810	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-18.66480	0.00000	-0.15122	-1.05810	20.84525	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	-0.24930	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	30.37380	0.00000	0.00000	0.00000	-29.87520	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	-0.24930	0.00000	0.00000	0.00000	0.00000	0.00000	30.37380	0.00000	0.00000	0.00000	-29.87520	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.62898	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	114.05317	0.00000	0.00000	0.00000	-112.79520	0.00000	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.62898	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	114.05317	0.00000	0.00000	0.00000	-112.79520	0.00000	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	-0.24930	0.00000	0.00000	-29.87520	0.00000	0.00000	0.00000	32.32486	0.00000	0.00000	0.00000	-1.80243	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.24930	-0.24930	0.00000	-29.87520	0.00000	0.00000	0.00000	32.32486	0.00000	0.00000	0.00000	-1.80243	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.62898	0.00000	-0.62898	0.00000	0.00000	-112.79520	0.00000	0.00000	0.00000	115.80717	0.00000	0.00000	0.00000	-1.19283	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-0.62898	0.00000	-0.62898	0.00000	0.00000	0.00000	0.00000	-112.79520	0.00000	0.00000	0.00000	115.80717	0.00000	0.00000	0.00000	-1.19283	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-1.80243	0.00000	0.00000	0.00000	2.59845	0.00000	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-1.80243	0.00000	0.00000	0.00000	2.59845	0.00000	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-1.19283	0.00000	0.00000	0.00000	1.98885	0.00000	
0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	0.00000	-1.19283	0.00000	0.00000	0.00000	1.98885];
    
g_amb = [0.09286	0.09286	0.09286	0.09286	0.00000	0.00000	0.00000	0.00000	0.14863	0.14863	0.56117	0.56117	0.79602	0.79602	0.79602	0.79602];
    
g0 = zeros(1, size(SplusG,2) - size(g_amb,2));
StimesT0 = [g0, g_amb*300];
StimesT0 = StimesT0';

% RTAS
%alpha_a = diag([0.0135 0.0135 0.0135 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]); % slope of power in active mode [W/K]
%alpha_i = diag([0.0135 0.0135 0.0135 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]); % slope of power in idle mode [W/K]
%beta_a = [16.460; 16.460; 16.460; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0]; % constant power in active mode [W]
%beta_i = [-3.811; -3.811; -3.811; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0]; % constant power in idle mode [W]

% TECS
cores = 4;
alpha_a = diag([0.042 * ones(1, cores), zeros(1, size(INVC,2)-cores)]);
alpha_i = alpha_a;

beta_a = [21 * ones(1, cores), zeros(1, size(INVC,2)-cores)]';
beta_i = [-7.0 * ones(1, cores), zeros(1, size(INVC,2)-cores)]';
%alpha_a = 0.5diag([0.022755102063125 0.022755102063124998 0.022755102063124998 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 zeros(1,180)]);
%alpha_i = 0.5* diag([0.022755102063125 0.022755102063124998 0.022755102063124998 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 zeros(1,180)]);
%beta_a = 0.5* [8.061353078616783; 8.061353078616783; 8.061353078616783; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; zeros(180,1)];
%beta_i = 0.5* [-5.512180221383218; -5.512180221383218; -5.512180221383218; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; 0; zeros(180,1)];


data = struct('INVC',INVC, 'SplusG',SplusG, 'g_amb',g_amb, 'StimesT0',StimesT0, ...
    'alpha_a',alpha_a, 'alpha_i',alpha_i, 'beta_a',beta_a, 'beta_i',beta_i, 't',t...
    , 'name',name, 'p', p);

[TM] = PBOOThermalModel(data);
